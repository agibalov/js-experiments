<form ng-submit="submitTeam($event)" tb-validation-facade="vf">
  <fieldset ng-disabled="busy">
    <div class="form-group name" ng-class="{'has-error': vf.isError('name')}">
      <label for="name" class="control-label">Name</label>
      <input type="text" class="form-control" id="name" name="name" ng-model="team.name">
      <p class="help-block" ng-if="vf.isError('name')">{{vf.getFieldError('name')}}</p>
    </div>
    <div id="no-members-alert" class="alert alert-info" ng-if="team.members.length === 0">
      There are no members in this team so far.
    </div>
    <div id="got-members-container" class="form-group" ng-class="{'has-error': vf.isError('members')}" ng-if="team.members.length > 0">
      <ul id="member-list" class="list-unstyled">
        <li ng-class="'member-' + {{$index}}" ng-repeat="member in team.members | orderBy:'person.id'">
          <div class="form-group form-inline">
            <strong>{{member.person.name}}</strong> is a
            <input type="text" ng-model="member.role" class="form-control input-sm">
            <button type="button" ng-click="removeMember(member)" class="btn btn-danger">Remove</button>
          </div>
        </li>
      </ul>
      <p class="help-block" ng-if="vf.isError('members')">{{vf.getFieldError('members')}}</p>
    </div>

    <div class="panel panel-default">
      <div class="panel-heading">
        <h4 class="panel-title">Add a new member</h4>
      </div>
      <div class="panel-body">
        <div class="form-group form-inline">
          <div class="form-group">
            <label for="newMemberName">Name</label>
            <input type="text"
              id="newMemberName"
              ng-model="newMember.person"
              typeahead="person as person.name for person in searchPeople($viewValue)"
              typeahead-editable="false"
              typeahead-template-url="teams/commons/personLookupItem.html"
              class="form-control">
          </div>
          <div class="form-group">
            <label for="newMemberRole">Role</label>
            <input type="text" id="newMemberRole" ng-model="newMember.role" class="form-control">
          </div>
          <button ng-click="addMember()" ng-disabled="!canAddMember()" type="button" class="btn btn-success">Add</button>
        </div>
      </div>
    </div>

    <div class="form-group">
      <button type="submit" class="btn btn-default">{{submitTitle}}</button>
    </div>
  </fieldset>
</form>
